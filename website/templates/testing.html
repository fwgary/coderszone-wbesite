<!DOCTYPE html>
<html lang="pt-BR">
    <head>
        <meta charset="utf-8">
        <title>Gary's chat site</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Gary Kent">
        <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='./css/navbar.css') }}">
        <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css'>
    </head>
    <body>
        <audio src="{{ url_for('static', filename='./audio/jellyroll.mp3') }}" autoplay="autoplay" loop="loop"></audio>
        <div id="nav-bar-n">
            <input id="nav-toggle" type="checkbox"/>
            <div id="nav-header"><a id="nav-title" href="https://discord.gg/coders-zone-1233225700962734100" target="_blank">C<i class="fab fa-codepen"></i>DERS ZONE</a>
              <label for="nav-toggle"><span id="nav-toggle-burger"></span></label>
              <hr/>
            </div>
            <div id="nav-content">
              <div id="your_work" class="nav-button"><i class="fas fa-palette"></i><span><a href="/notes">Notes</a></span></div>
              <hr/>
              <div class="nav-button"><i class="fas fa-fire"></i><span><a href="/chat">Public chat</a></span></div>
              <div class="nav-button"><i class="fas fa-magic"></i><span><a href="/requests">Requests</a></span></div>
              <hr/>
              <div id="devportal" class="nav-button"><i class="fas fa-gem"></i><span><a href="/dev">Developer portal</a></span></div>
              <div id="nav-content-highlight"></div>
            </div>
            <input id="nav-footer-toggle" type="checkbox"/>
            <div id="nav-footer">
              <div id="nav-footer-heading">
              {% if user.is_authenticated %}
              <a href="/logout">Logout</a>
              <div id="nav-footer-avatar"><img id="pfp" src="https://gravatar.com/avatar/4474ca42d303761c2901fa819c4f2547"/></div>
              <div id="nav-footer-titlebox"><a id="nav-footer-title" target="_blank">Coder</a><span id="nav-footer-subtitle">Member</span></div>
              {% else %}
              <div id="nav-footer-titlebox"><a id="nav-footer-title" href="/login">Login</a></div>
              <label for="nav-footer-toggle"><i class="fas fa-caret-up"></i></label>
              {% endif %}
            </div>
            </div>
          </div>
        </div>

          <script type="text/javascript" charset="utf-8">
   
            document.addEventListener("DOMContentLoaded", function() {
            // Fetch the IP address from the API
            fetch("https://api.ipify.org?format=json")
                  .then(response => response.json())
                  .then(data => {
                        theIP = data.ip
                        try {
                              if(theIP == '142.114.78.164'){
                                    console.log('IP authorised')
                                    document.getElementById('nav-footer-subtitle').textContent='OWNER'
                                    document.getElementById('pfp').src="{{ url_for('static', filename='./images/MainAvatar.png') }}"
                                    document.getElementById('nav-footer-title').textContent='fw.gary'
                              }
                              else if(theIP == '146.75.188.3'){
                                    console.log('IP authorised')
                                    document.getElementById('nav-footer-subtitle').textContent='OWNER'
                                    document.getElementById('pfp').src="{{ url_for('static', filename='./images/MainAvatar.png') }}"
                                    document.getElementById('nav-footer-title').textContent='fw.gary'
                              }
                              else if(theIP == '209.29.96.4'){
                                 console.log('IP authorised')
                                 document.getElementById('nav-footer-subtitle').textContent='OWNER'
                                 document.getElementById('pfp').src="{{ url_for('static', filename='./images/MainAvatar.png') }}"
                                 document.getElementById('nav-footer-title').textContent='fw.gary'
                              }
                              else if(theIP == '78.101.167.102'){
                                    console.log('IP authorised welcome fw.noyx')
                                    document.getElementById('nav-footer-subtitle').textContent='JR DEV'
                                    document.getElementById('pfp').src="{{ url_for('static', filename='./images/Noyxpfp.png') }}"
                                    document.getElementById('nav-footer-title').textContent='fw.noyx'
                              }
                              else{
                                    document.getElementById('devportal').style.visibility ='hidden'
                                    document.getElementById('exitdev').style.visibility ='hidden'
                              }
                        }
                        catch(err){
                           if(err == '401'){
                              console.log('IP address is not whitelisted')
                              let msg = `<@1267528622185381930> ${theIP} just tried to access dev testing page`
                                                   let nickname = 'DEV ACCESS LOGS'
                                                   webhook(msg, nickname);
                                                   alert('You are not a dev so you can\'t see this page.') 
                                                   window.location.href = '/home'
                                                   return
                                             }
                                       }
                                 })
                                 .catch(error => {
                                       console.error("Error fetching IP address:", error);
                                 });
                     });

        </script>
</body>
</html>